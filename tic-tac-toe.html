<!DOCTYPE html>
<html>
	<head>
		<title>Tic Tac Toe</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<style>
			td:nth-child(2) {
				border-left: 1px solid #555555;
				border-right: 1px solid #555555;
			}
			tr:nth-child(2) > td {
				border-top: 1px solid #555555;
				border-bottom: 1px solid #555555;
			}
			table table {
				margin: 10px;
			}
			table table td {
				height: 50px;
				width: 50px;
				text-align: center;
			}
			table {
				border-collapse: collapse;
			}
		</style>
	</head>
	<body>
		<table id="ultimate"></table>
		<script>
			var turn = true; // true: X, false: O
			var grid = [
				[
					[["", "", ""], ["", "", ""], ["", "", ""]], // 0, 0
					[["", "", ""], ["", "", ""], ["", "", ""]], // 0, 1
					[["", "", ""], ["", "", ""], ["", "", ""]]  // 0, 2
				],
				[
					[["", "", ""], ["", "", ""], ["", "", ""]], // 1, 0
					[["", "", ""], ["", "", ""], ["", "", ""]], // 1, 1
					[["", "", ""], ["", "", ""], ["", "", ""]]  // 1, 2
				],
				[
					[["", "", ""], ["", "", ""], ["", "", ""]], // 2, 0
					[["", "", ""], ["", "", ""], ["", "", ""]], // 2, 1
					[["", "", ""], ["", "", ""], ["", "", ""]]  // 2, 2
				]
			];
			
			$(document).ready(function() {
				var innerhtml = "";
				for (var row = 0; row < 3; row++) {
					innerhtml += "<tr>"
					for (var col = 0; col < 3; col++) {
						innerhtml += "<td><table data-row=\"" + row + "\" data-column=\"" + col + "\">";
						for (var i = 0; i < 3; i++) {
							innerhtml += "<tr>";
							for (var j = 0; j < 3; j++) {
								innerhtml += "<td data-row=\"" + i + "\" data-column=\"" + j + "\"></td>";
							}
							innerhtml += "</tr>";
						}
						innerhtml += "</table></td>";
					}
					innerhtml += "</tr>"
				}
			
				$("#ultimate").html(innerhtml);
				$("table table td").click(function() {
					var row = Number($($(this).parents("table:not(#ultimate)")[0]).data("row"));
					var col = Number($($(this).parents("table:not(#ultimate)")[0]).data("column"));
					var i = Number($(this).data("row"));
					var j = Number($(this).data("column"));
					console.log(row, col, i, j);
					if (grid[row][col][i][j] === "") {
						grid[row][col][i][j] = turn ? "X" : "O";
					}
					/*if (winner()) {
						alert((turn ? "X" : "O") + " won! Congrats!");
						grid = [[[["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]] ], [ [["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]] ], [ [["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]]]];
						turn = false;
					}
					if (tie()) {
						alert("Tie!");
						grid = [[[["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]] ], [ [["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]] ], [ [["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]], [["", "", ""], ["", "", ""], ["", "", ""]]]];
						turn = false;
					}*/
					turn = !turn;
					$(this).html(grid[row][col][i][j]);
				});
			});
			function tie() {
				var result = true;
				for (var i = 0; i < 3; i++) {
					for (var j = 0; j < 3; j++) {
						if (grid[i][j] === "") {
							result = false;
						}
					}
				}
				return result;
			}
			function winner() {
				var result = false;
				for (var i = 0; i < 3; i++) {
					result = result || JSON.stringify(grid[i]) === JSON.stringify(["X","X","X"]);
					result = result || JSON.stringify(grid[i]) === JSON.stringify(["O","O","O"]);
			
					result = result || JSON.stringify([grid[0][i], grid[1][i], grid[2][i]]) === JSON.stringify(["X", "X", "X"]);
					result = result || JSON.stringify([grid[0][i], grid[1][i], grid[2][i]]) === JSON.stringify(["O", "O", "O"]);
				}
				result = result || JSON.stringify([grid[0][0], grid[1][1], grid[2][2]]) === JSON.stringify(["X", "X", "X"]);
				result = result || JSON.stringify([grid[0][0], grid[1][1], grid[2][2]]) === JSON.stringify(["O", "O", "O"]);
			
				result = result || JSON.stringify([grid[0][2], grid[1][1], grid[2][0]]) === JSON.stringify(["X", "X", "X"]);
				result = result || JSON.stringify([grid[0][2], grid[1][1], grid[2][0]]) === JSON.stringify(["O", "O", "O"]);
				return result;
			}
		</script>
	</body>
</html>
